dependencies:
  cache_directories:
    - "~/.stack"
  pre:
    - wget -qO- https://get.haskellstack.org/ | sh
    - cp ./scripts/* ~/bin/
  override:
    - cabal update
    - fetch
    - stack setup
    - stack clean
    - stack init --resolver ghc-8

test:
  override:
    - stack test

deployment:
  release_branch:
    owner: haskell-works
    branch: /.*-branch/
    commands:
      - nox when tag autotag

  # hackage:
  #   owner: haskell-works
  #   tag: /v.*/
  #   commands:
  #     - nox when deploy nix-shell shell.nix --command publish
